# Chapter 4.2: Route Groups & Organization

## Overview

As applications grow, organizing routes becomes critical. The App Router provides several conventions for structuring your project without affecting URL paths. This chapter covers route groups, private folders, and project organization strategies.

## Route Groups

Route groups let you organize routes into logical sections without adding segments to the URL. Create them by wrapping a folder name in parentheses.

```
app/
├── (marketing)/
│   ├── about/
│   │   └── page.tsx   →  /about
│   ├── pricing/
│   │   └── page.tsx   →  /pricing
│   └── layout.tsx     # Marketing-specific layout
└── (dashboard)/
    ├── settings/
    │   └── page.tsx   →  /settings
    ├── profile/
    │   └── page.tsx   →  /profile
    └── layout.tsx     # Dashboard-specific layout
```

The `(marketing)` and `(dashboard)` folders don't appear in URLs.

### Different Layouts for Different Sections

Route groups shine when sections need different layouts:

```tsx
// app/(marketing)/layout.tsx
export default function MarketingLayout({ children }) {
  return (
    <div className="marketing">
      <header className="marketing-header">
        <nav>
          <a href="/">Home</a>
          <a href="/about">About</a>
          <a href="/pricing">Pricing</a>
        </nav>
        <a href="/dashboard" className="cta">Get Started</a>
      </header>
      <main>{children}</main>
      <footer className="marketing-footer">
        <p>© 2024 MyApp</p>
      </footer>
    </div>
  );
}

// app/(dashboard)/layout.tsx
export default function DashboardLayout({ children }) {
  return (
    <div className="dashboard">
      <aside className="sidebar">
        <nav>
          <a href="/settings">Settings</a>
          <a href="/profile">Profile</a>
          <a href="/billing">Billing</a>
        </nav>
      </aside>
      <main className="dashboard-content">{children}</main>
    </div>
  );
}
```

### Multiple Root Layouts

Route groups can have their own root layouts:

```
app/
├── (marketing)/
│   ├── layout.tsx     # Has <html> and <body>
│   ├── page.tsx       →  /
│   └── about/
│       └── page.tsx   →  /about
└── (app)/
    ├── layout.tsx     # Different <html> and <body>
    └── dashboard/
        └── page.tsx   →  /dashboard
```

When using multiple root layouts:
- Each must define `<html>` and `<body>`
- Navigation between groups causes a full page load
- There's no shared root layout

```tsx
// app/(marketing)/layout.tsx
export default function MarketingRoot({ children }) {
  return (
    <html lang="en">
      <body className="marketing-theme">{children}</body>
    </html>
  );
}

// app/(app)/layout.tsx
export default function AppRoot({ children }) {
  return (
    <html lang="en">
      <body className="app-theme">{children}</body>
    </html>
  );
}
```

### Organizing by Feature

Group routes by feature while maintaining clean URLs:

```
app/
├── (auth)/
│   ├── login/
│   │   └── page.tsx   →  /login
│   ├── register/
│   │   └── page.tsx   →  /register
│   └── layout.tsx     # Auth pages layout (centered form)
├── (shop)/
│   ├── products/
│   │   └── page.tsx   →  /products
│   ├── cart/
│   │   └── page.tsx   →  /cart
│   └── layout.tsx     # Shop layout (with cart sidebar)
└── layout.tsx         # Root layout
```

## Private Folders

Prefix a folder with `_` to exclude it from routing entirely. These folders are for organization only.

```
app/
├── _components/
│   ├── Header.tsx
│   ├── Footer.tsx
│   └── Sidebar.tsx
├── _lib/
│   ├── utils.ts
│   └── api.ts
├── _hooks/
│   └── useAuth.ts
├── dashboard/
│   └── page.tsx
└── page.tsx
```

Nothing in `_components`, `_lib`, or `_hooks` creates routes.

### Colocation with Private Folders

Keep related code together:

```
app/
└── blog/
    ├── _components/
    │   ├── PostCard.tsx
    │   ├── PostList.tsx
    │   └── CategoryFilter.tsx
    ├── _hooks/
    │   └── usePosts.ts
    ├── _lib/
    │   └── formatDate.ts
    ├── page.tsx
    └── [slug]/
        ├── _components/
        │   └── CommentSection.tsx
        └── page.tsx
```

### When to Use Private Folders

Use `_folders` for:
- Components specific to a route segment
- Utility functions
- Custom hooks
- Types/interfaces
- Test files

## Project Structure Strategies

### Strategy 1: Flat with Private Folders

Best for: Small to medium projects

```
app/
├── _components/
│   ├── ui/
│   │   ├── Button.tsx
│   │   ├── Card.tsx
│   │   └── Modal.tsx
│   └── layout/
│       ├── Header.tsx
│       └── Footer.tsx
├── _lib/
│   ├── utils.ts
│   └── api.ts
├── page.tsx
├── about/
│   └── page.tsx
├── blog/
│   ├── page.tsx
│   └── [slug]/
│       └── page.tsx
└── contact/
    └── page.tsx
```

### Strategy 2: Feature-Based with Route Groups

Best for: Medium to large projects with distinct sections

```
app/
├── (marketing)/
│   ├── _components/
│   │   └── HeroSection.tsx
│   ├── layout.tsx
│   ├── page.tsx
│   ├── about/
│   │   └── page.tsx
│   └── pricing/
│       └── page.tsx
├── (app)/
│   ├── _components/
│   │   ├── Sidebar.tsx
│   │   └── DashboardCard.tsx
│   ├── layout.tsx
│   └── dashboard/
│       ├── page.tsx
│       └── settings/
│           └── page.tsx
└── _shared/
    ├── components/
    │   └── Logo.tsx
    └── lib/
        └── auth.ts
```

### Strategy 3: Domain-Driven

Best for: Large applications with multiple domains/modules

```
app/
├── (auth)/
│   ├── _lib/
│   │   └── authService.ts
│   ├── login/
│   │   └── page.tsx
│   └── register/
│       └── page.tsx
├── (users)/
│   ├── _lib/
│   │   └── userService.ts
│   ├── _components/
│   │   └── UserCard.tsx
│   ├── profile/
│   │   └── page.tsx
│   └── settings/
│       └── page.tsx
├── (products)/
│   ├── _lib/
│   │   └── productService.ts
│   ├── _components/
│   │   ├── ProductCard.tsx
│   │   └── ProductGrid.tsx
│   └── [id]/
│       └── page.tsx
└── layout.tsx
```

### Strategy 4: Outside App Directory

Keep most code outside `app/`, use `app/` only for routing:

```
project/
├── app/
│   ├── layout.tsx
│   ├── page.tsx
│   ├── about/
│   │   └── page.tsx
│   └── blog/
│       └── [slug]/
│           └── page.tsx
├── components/
│   ├── ui/
│   │   ├── Button.tsx
│   │   └── Card.tsx
│   └── features/
│       ├── blog/
│       │   └── PostCard.tsx
│       └── auth/
│           └── LoginForm.tsx
├── lib/
│   ├── utils.ts
│   └── api.ts
├── hooks/
│   └── useAuth.ts
└── styles/
    └── globals.css
```

Pages import from outside:

```tsx
// app/blog/[slug]/page.tsx
import { PostCard } from '@/components/features/blog/PostCard';
import { getPost } from '@/lib/api';

export default async function BlogPost({ params }) {
  const { slug } = await params;
  const post = await getPost(slug);
  return <PostCard post={post} />;
}
```

## Examples

### Basic Example

```
app/
├── layout.tsx
├── page.tsx
├── about/
│   └── page.tsx
└── contact/
    └── page.tsx
```

Simple flat structure for small sites.

### Normal Example

```
app/
├── _components/
│   ├── Header.tsx
│   └── Footer.tsx
├── layout.tsx
├── page.tsx
├── (marketing)/
│   ├── about/
│   │   └── page.tsx
│   └── pricing/
│       └── page.tsx
└── (app)/
    ├── layout.tsx
    └── dashboard/
        ├── page.tsx
        └── settings/
            └── page.tsx
```

Route groups separate marketing from app with different layouts.

### Complex Example

```
app/
├── _shared/
│   ├── components/
│   │   ├── ui/
│   │   │   ├── Button.tsx
│   │   │   ├── Input.tsx
│   │   │   └── Modal.tsx
│   │   └── layout/
│   │       ├── Header.tsx
│   │       ├── Footer.tsx
│   │       └── Sidebar.tsx
│   ├── hooks/
│   │   ├── useAuth.ts
│   │   └── useLocalStorage.ts
│   └── lib/
│       ├── api.ts
│       ├── utils.ts
│       └── constants.ts
├── (marketing)/
│   ├── _components/
│   │   ├── Hero.tsx
│   │   ├── Features.tsx
│   │   └── Testimonials.tsx
│   ├── layout.tsx
│   ├── page.tsx
│   ├── about/
│   │   └── page.tsx
│   ├── pricing/
│   │   └── page.tsx
│   └── blog/
│       ├── _components/
│       │   ├── PostCard.tsx
│       │   └── CategoryList.tsx
│       ├── page.tsx
│       └── [slug]/
│           └── page.tsx
├── (app)/
│   ├── _components/
│   │   ├── DashboardNav.tsx
│   │   └── StatsCard.tsx
│   ├── layout.tsx
│   └── dashboard/
│       ├── loading.tsx
│       ├── error.tsx
│       ├── page.tsx
│       ├── analytics/
│       │   └── page.tsx
│       └── settings/
│           ├── page.tsx
│           └── profile/
│               └── page.tsx
├── (auth)/
│   ├── _components/
│   │   └── AuthForm.tsx
│   ├── layout.tsx
│   ├── login/
│   │   └── page.tsx
│   └── register/
│       └── page.tsx
├── api/
│   ├── auth/
│   │   └── route.ts
│   └── posts/
│       └── route.ts
└── layout.tsx
```

### Edge Case Example: Conflicting Routes

Be careful with route groups—you can accidentally create conflicts:

```
app/
├── (marketing)/
│   └── about/
│       └── page.tsx   →  /about
└── (company)/
    └── about/
        └── page.tsx   →  /about  ← CONFLICT!
```

Both resolve to `/about`. Next.js will throw an error.

**Fix:** Only have the route in one group:

```
app/
├── (marketing)/
│   └── about/
│       └── page.tsx   →  /about
└── (company)/
    └── team/
        └── page.tsx   →  /team
```

## Best Practices

### 1. Keep Routes Shallow

Avoid deeply nested routes when possible:

```
# ❌ Too deep
app/dashboard/settings/account/security/two-factor/page.tsx

# ✅ Flatter
app/dashboard/security/page.tsx  (show 2FA settings here)
```

### 2. Use Route Groups for Layout Boundaries

Don't create route groups just for organization—use them when you need different layouts:

```
# ✅ Good: Different layouts
(marketing) - public layout with nav
(dashboard) - authenticated layout with sidebar

# ❌ Unnecessary: Same layout
(pages)/about
(pages)/contact
# Just use flat structure instead
```

### 3. Colocate When Possible

Keep related files close:

```
# ✅ Good: Related files together
app/blog/
├── _components/
│   └── PostCard.tsx    # Only used in blog
├── page.tsx
└── [slug]/page.tsx

# ❌ Avoid: Components far from usage
app/blog/page.tsx
components/blog/PostCard.tsx  # Far from where it's used
```

### 4. Shared vs. Feature-Specific

Distinguish between shared and feature-specific code:

```
app/
├── _shared/           # Used across multiple features
│   └── components/
│       └── Button.tsx
├── blog/
│   ├── _components/   # Only used in blog
│   │   └── PostCard.tsx
│   └── page.tsx
└── shop/
    ├── _components/   # Only used in shop
    │   └── ProductCard.tsx
    └── page.tsx
```

### 5. Be Consistent

Pick a structure and stick with it. Inconsistency makes projects hard to navigate:

```
# ❌ Inconsistent
app/
├── components/        # Top level
├── blog/
│   └── _components/   # Private folder style
└── shop/
    └── shopComponents/ # Different naming
    
# ✅ Consistent
app/
├── _components/       # All use same pattern
├── blog/
│   └── _components/
└── shop/
    └── _components/
```

## Key Takeaways

- Route groups `(name)` organize routes without affecting URLs
- Use route groups when you need different layouts for different sections
- Private folders `_name` are completely excluded from routing
- Colocate components with the routes that use them
- Choose a project structure strategy and apply it consistently
- Avoid creating conflicting routes with route groups
- Keep route nesting reasonably shallow

## Questions & Answers

### Q: Can I nest route groups?
**A:** Yes, you can nest them:
```
app/(shop)/(checkout)/payment/page.tsx → /payment
```
But this is rarely needed. Keep it simple.

### Q: Do route groups affect imports?
**A:** No. You can import across route groups normally:
```tsx
// app/(dashboard)/settings/page.tsx
import { Button } from '@/app/(marketing)/_components/Button';
```

### Q: Can I have a page.tsx directly in a route group?
**A:** Yes:
```
app/(marketing)/page.tsx → /
```
The route group's page becomes the root of that group.

### Q: What's the difference between `_folder` and `(folder)`?
**A:**
- `_folder`: Completely ignored by router (for non-route files)
- `(folder)`: Creates a route segment that's hidden from the URL

### Q: Can I mix strategies?
**A:** Yes, but be intentional. A hybrid approach can work:
```
app/
├── _components/      # Shared components (private folder)
├── (marketing)/      # Route group for marketing
└── dashboard/        # Regular route for app
```

### Q: How do I handle shared state between route groups?
**A:** Use the root layout or React Context in a shared parent. Route groups with separate root layouts don't share state.

## Resources

- [Next.js: Route Groups](https://nextjs.org/docs/app/building-your-application/routing/route-groups)
- [Next.js: Project Organization](https://nextjs.org/docs/app/building-your-application/routing/colocation)
- [Next.js: Private Folders](https://nextjs.org/docs/app/building-your-application/routing/colocation#private-folders)

---

**Next Chapter:** [5. Routing & Navigation](./05-routing-navigation.md) - Learn about dynamic routes, navigation components, and programmatic navigation.
