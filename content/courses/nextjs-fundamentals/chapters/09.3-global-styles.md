# Chapter 9.3: Global Styles & Best Practices

## Overview

Global styles set the foundation for your application‚Äîresets, base typography, CSS variables, and shared utilities. This chapter covers organizing your styles for maintainability and performance.

## Global CSS in Next.js

Import global styles in your root layout:

```css
/* app/globals.css */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom global styles below */
```

```tsx
// app/layout.tsx
import './globals.css';

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  );
}
```

## CSS Reset / Base Styles

### Modern CSS Reset

```css
/* app/globals.css */

/* Box sizing */
*,
*::before,
*::after {
  box-sizing: border-box;
}

/* Remove default margin/padding */
* {
  margin: 0;
  padding: 0;
}

/* Improve text rendering */
body {
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
}

/* Improve media defaults */
img,
picture,
video,
canvas,
svg {
  display: block;
  max-width: 100%;
}

/* Remove built-in form typography */
input,
button,
textarea,
select {
  font: inherit;
}

/* Avoid text overflows */
p,
h1,
h2,
h3,
h4,
h5,
h6 {
  overflow-wrap: break-word;
}

/* Root stacking context */
#root,
#__next {
  isolation: isolate;
}
```

### With Tailwind

Tailwind's `@tailwind base` includes Preflight, a modern CSS reset. Customize it:

```css
@tailwind base;

@layer base {
  html {
    scroll-behavior: smooth;
  }
  
  body {
    @apply bg-gray-50 text-gray-900;
  }
  
  h1 {
    @apply text-4xl font-bold;
  }
  
  h2 {
    @apply text-3xl font-semibold;
  }
  
  a {
    @apply text-blue-600 hover:text-blue-800;
  }
}

@tailwind components;
@tailwind utilities;
```

## CSS Variables (Custom Properties)

### Defining Variables

```css
/* app/globals.css */
:root {
  /* Colors */
  --color-primary: #0070f3;
  --color-primary-dark: #0060df;
  --color-secondary: #6b7280;
  --color-success: #10b981;
  --color-warning: #f59e0b;
  --color-error: #ef4444;
  
  /* Typography */
  --font-sans: 'Inter', system-ui, sans-serif;
  --font-mono: 'Fira Code', monospace;
  
  /* Spacing */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;
  
  /* Borders */
  --radius-sm: 0.25rem;
  --radius-md: 0.5rem;
  --radius-lg: 1rem;
  --radius-full: 9999px;
  
  /* Shadows */
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
  
  /* Transitions */
  --transition-fast: 150ms ease;
  --transition-normal: 300ms ease;
}

/* Dark mode overrides */
[data-theme='dark'] {
  --color-primary: #3b82f6;
  --color-background: #1a1a1a;
  --color-text: #ffffff;
}
```

### Using Variables

```css
.button {
  background: var(--color-primary);
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: var(--radius-md);
  transition: background var(--transition-fast);
}

.button:hover {
  background: var(--color-primary-dark);
}
```

### With Tailwind

```ts
// tailwind.config.ts
import type { Config } from 'tailwindcss';

const config: Config = {
  content: ['./app/**/*.{js,ts,jsx,tsx,mdx}', './components/**/*.{js,ts,jsx,tsx,mdx}'],
  theme: {
    extend: {
      colors: {
        primary: 'var(--color-primary)',
        'primary-dark': 'var(--color-primary-dark)',
      },
    },
  },
  plugins: [],
};

export default config;
```

## File Organization

### Recommended Structure

```
styles/
‚îú‚îÄ‚îÄ globals.css         # Global styles, imports
‚îú‚îÄ‚îÄ variables.css       # CSS custom properties
‚îú‚îÄ‚îÄ reset.css          # CSS reset (if not using Tailwind)
‚îú‚îÄ‚îÄ typography.css     # Base typography
‚îî‚îÄ‚îÄ utilities.css      # Custom utility classes

components/
‚îú‚îÄ‚îÄ Button/
‚îÇ   ‚îú‚îÄ‚îÄ Button.tsx
‚îÇ   ‚îî‚îÄ‚îÄ Button.module.css
‚îî‚îÄ‚îÄ Card/
    ‚îú‚îÄ‚îÄ Card.tsx
    ‚îî‚îÄ‚îÄ Card.module.css
```

### Import Order

```css
/* app/globals.css */

/* 1. External libraries */
@import 'normalize.css';

/* 2. Tailwind layers */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* 3. Custom variables */
@import '../styles/variables.css';

/* 4. Base/reset styles */
@import '../styles/reset.css';

/* 5. Typography */
@import '../styles/typography.css';

/* 6. Custom utilities */
@import '../styles/utilities.css';
```

## Typography System

```css
/* styles/typography.css */

/* Type scale */
:root {
  --text-xs: 0.75rem;
  --text-sm: 0.875rem;
  --text-base: 1rem;
  --text-lg: 1.125rem;
  --text-xl: 1.25rem;
  --text-2xl: 1.5rem;
  --text-3xl: 1.875rem;
  --text-4xl: 2.25rem;
}

/* Headings */
h1, .h1 {
  font-size: var(--text-4xl);
  font-weight: 700;
  line-height: 1.2;
  letter-spacing: -0.025em;
}

h2, .h2 {
  font-size: var(--text-3xl);
  font-weight: 600;
  line-height: 1.3;
}

h3, .h3 {
  font-size: var(--text-2xl);
  font-weight: 600;
  line-height: 1.4;
}

/* Body text */
.text-body {
  font-size: var(--text-base);
  line-height: 1.6;
}

.text-small {
  font-size: var(--text-sm);
  line-height: 1.5;
}

/* Links */
a {
  color: var(--color-primary);
  text-decoration: none;
  transition: color var(--transition-fast);
}

a:hover {
  color: var(--color-primary-dark);
  text-decoration: underline;
}

/* Prose (for markdown/article content) */
.prose {
  max-width: 65ch;
}

.prose p {
  margin-bottom: 1.25em;
}

.prose h2 {
  margin-top: 2em;
  margin-bottom: 0.75em;
}

.prose ul,
.prose ol {
  padding-left: 1.5em;
  margin-bottom: 1.25em;
}

.prose li {
  margin-bottom: 0.5em;
}

.prose code {
  background: #f3f4f6;
  padding: 0.2em 0.4em;
  border-radius: 0.25em;
  font-size: 0.875em;
}

.prose pre {
  background: #1f2937;
  color: #f9fafb;
  padding: 1rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  margin-bottom: 1.25em;
}
```

## Utility Classes

### Custom Utilities

```css
/* styles/utilities.css */

/* Layout */
.container {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 1rem;
}

/* Flexbox shortcuts */
.flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

.flex-between {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/* Visually hidden (accessible) */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Focus visible */
.focus-ring {
  outline: none;
}

.focus-ring:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

/* Truncate text */
.truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Animation utilities */
@keyframes spin {
  to { transform: rotate(360deg); }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

.animate-fade-in {
  animation: fade-in 0.3s ease-out;
}
```

## Dark Mode Implementation

### CSS Variables Approach

```css
/* app/globals.css */
:root {
  --bg-primary: #ffffff;
  --bg-secondary: #f3f4f6;
  --text-primary: #111827;
  --text-secondary: #6b7280;
  --border-color: #e5e7eb;
}

[data-theme='dark'] {
  --bg-primary: #111827;
  --bg-secondary: #1f2937;
  --text-primary: #f9fafb;
  --text-secondary: #9ca3af;
  --border-color: #374151;
}

body {
  background: var(--bg-primary);
  color: var(--text-primary);
}
```

```tsx
// components/ThemeToggle.tsx
'use client';

import { useEffect, useState } from 'react';

type Theme = 'light' | 'dark';

export function ThemeToggle() {
  const [theme, setTheme] = useState<Theme>('light');

  useEffect(() => {
    const saved = (localStorage.getItem('theme') as Theme) || 'light';
    setTheme(saved);
    document.documentElement.setAttribute('data-theme', saved);
  }, []);

  const toggle = () => {
    const newTheme: Theme = theme === 'light' ? 'dark' : 'light';
    setTheme(newTheme);
    localStorage.setItem('theme', newTheme);
    document.documentElement.setAttribute('data-theme', newTheme);
  };

  return (
    <button onClick={toggle}>
      {theme === 'light' ? 'üåô' : '‚òÄÔ∏è'}
    </button>
  );
}
```

## Performance Best Practices

### 1. Minimize Global Styles

```css
/* ‚ùå Avoid: Too many global styles */
button {
  /* ... lots of styles */
}

/* ‚úÖ Better: Use classes */
.btn {
  /* ... */
}
```

### 2. Use CSS Layers

```css
@layer base, components, utilities;

@layer base {
  /* Reset and base styles */
}

@layer components {
  /* Component classes */
}

@layer utilities {
  /* Utility classes - highest priority */
}
```

### 3. Avoid Deep Selectors

```css
/* ‚ùå Avoid: Deep nesting */
.header .nav .nav-list .nav-item .nav-link {
  color: blue;
}

/* ‚úÖ Better: Flat selectors */
.nav-link {
  color: blue;
}
```

### 4. Use CSS Containment

```css
.card {
  contain: content; /* Isolates layout/paint */
}
```

## Best Practices Summary

1. **Use CSS Variables** for theming and consistency
2. **Keep global styles minimal** - prefer component styles
3. **Organize files logically** - variables, reset, typography, utilities
4. **Use meaningful class names** - BEM or utility-based
5. **Mobile-first responsive** - start with mobile, add breakpoints
6. **Test dark mode** - ensure contrast ratios are accessible
7. **Purge unused CSS** - Tailwind does this automatically
8. **Document your system** - comment complex styles

## Key Takeaways

- Import global CSS in root layout only
- Use CSS variables for theming and consistency
- Organize styles: variables ‚Üí reset ‚Üí base ‚Üí components ‚Üí utilities
- Keep global styles minimal
- Use `@layer` for style organization
- Test both light and dark modes
- Performance: flat selectors, CSS containment, purge unused

## Resources

- [Next.js: CSS Support](https://nextjs.org/docs/app/building-your-application/styling)
- [Modern CSS Reset](https://www.joshwcomeau.com/css/custom-css-reset/)
- [CSS Custom Properties](https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties)
- [CSS Layers](https://developer.mozilla.org/en-US/docs/Web/CSS/@layer)

